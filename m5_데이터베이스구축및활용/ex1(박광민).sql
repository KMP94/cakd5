CREATE TABLE MARKET(
MARKETID NUMBER(10) NOT NULL,
CUSTID NUMBER(10) NOT NULL,
PAY NUMBER(15),
LOCATION VARCHAR2(20),
BUYDATE DATE,
TIME NUMBER(2)
);
CREATE TABLE CUSTOMERINFO(
CUSTID NUMBER(10) NOT NULL,
SALARY NUMBER(15),
CITY VARCHAR2(20)
);

DROP TABLE MARKET;
DROP TABLE CUSTOMERINFO;

ALTER TABLE MARKET MODIFY(MARKETID NUMBER(20), CUSTID NUMBER(20));
ALTER TABLE CUSTOMERINFO MODIFY CUSTID NUMBER(20);
ALTER TABLE MARKET RENAME COLUMN PAY TO BILLING;
ALTER TABLE CUSTOMERINFO ADD CONSTRAINT CUSTID_PK PRIMARY KEY(CUSTID);
SAVEPOINT SAVE1;
INSERT INTO MARKET VALUES('0044234','11111',1000000,'서울강동구','20/02/22','11');
INSERT INTO MARKET VALUES('0044235','11112',1050000,'서울송파구','20/02/21','8');
ROLLBACK TO SAVE1;
SAVEPOINT SAVE2;
INSERT INTO MARKET VALUES('0044234','11111',1000000,'서울','20/02/22','10');
INSERT INTO MARKET VALUES('0044238','11112',800000,'경기','20/02/22','11');
INSERT INTO CUSTOMERINFO VALUES('11111','10000000','서울');
INSERT INTO CUSTOMERINFO VALUES('11112','40000000','경기');
ROLLBACK TO SAVE2;
INSERT INTO MARKET VALUES('0044234','11111',1000000,'서울','20/02/22','10');
INSERT INTO MARKET VALUES('0044235','11112',800000,'경기','20/02/22','11');
INSERT INTO MARKET VALUES('0044240','11125',904000,'부산','20/02/22','10');
INSERT INTO MARKET VALUES('0044260','11140',801000,'대구','20/02/22','11');
INSERT INTO CUSTOMERINFO VALUES('11111','10000000','서울');
INSERT INTO CUSTOMERINFO VALUES('11112','40300000','경기');
INSERT INTO CUSTOMERINFO VALUES('11150','1120000','충북');
INSERT INTO CUSTOMERINFO VALUES('11160','40050000','강원도');

SELECT * FROM MARKET;
SELECT * FROM CUSTOMERINFO;

commit;

select *
from MARKET M, CUSTOMERINFO C
where M.CUSTID = C.CUSTID;

select *
from MARKET M, CUSTOMERINFO C
where M.CUSTID = C.CUSTID(+);

select *
from MARKET M, CUSTOMERINFO C
where M.CUSTID(+) = C.CUSTID;


--Q.[과제] HR EMPLOYEES 테이블에서 escape 옵션을 사용하여 아래와 같이 출력되는 SQL문을 작성하세요. 
--job_id 칼럼에서  _을 와일드카드가 아닌 문자로 취급하여 '_A'를 포함하는  모든 행을 출력

--Q.  employees 테이블에서 이름에 FIRST_NAME에 LAST_NAME을 붙여서 'NAME' 컬럼명으로 출력하세요.
--예) Steven King --Q. Seo라는 사람의 부서명을 출력하세요.

--q Seo라는 사람의 부섬여을 출력하세요.

--hr테이블을 분석해서 전체 현황을 설명할 수 있는 요약 테이블 3개를 작성하세요.
ex부서별 연봉 순위